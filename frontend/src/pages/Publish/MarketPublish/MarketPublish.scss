@import '../../../styles/mixins.scss';

// 颜色变量（参考商城页面风格）
$wechat-bg: #ededed;        // 微信对话背景灰
$panel-bg: #f9f9f9;          // 面板背景（来自Market.scss）
$list-bg: rgb(228, 228, 228); // 列表背景（来自Market.scss）
$card-bg: #fff;              // 卡片背景（来自Market.scss）
$border-color: #d9d9d9;      // 边框颜色
$user-msg-bg: #95ec69;       // 用户消息背景（微信绿）
$ai-msg-bg: #ffffff;         // AI消息背景（白色）
$ai-msg-border: #e0e0e0;     // AI消息边框

.publish-container {
    width: 100vw;
    max-width: 100vw;
    height: calc(100vh - #{px2rem(50)});
    max-height: calc(100vh - #{px2rem(50)});
    overflow-x: hidden;
    overflow-y: hidden;
    margin-top: px2rem(50);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    background: $wechat-bg; // 微信对话背景
    
    .dialog-container {
        overflow-y: auto;
        overflow-x: hidden;
        display: flex;
        flex-direction: column;
        width: 100%;
        flex: 1;
        @include padding(10, 0, 15, 0);
        box-sizing: border-box;
        background: $wechat-bg; // 对话区域背景
        
        // 移除背景图片
        .dialog-bg {
            display: none;
        }
        .dialog-user {
            display: flex;
            flex-direction: row-reverse;
            align-items: center;
            justify-content: flex-start;
            width: px2rem(240);
            height: auto;
            margin-top: px2rem(10);
            margin-bottom: px2rem(10);
            margin-left: auto;
            margin-right: px2rem(15); // 距右边15px
            .dialog-face {
                @include size(32);
                margin-left: px2rem(10); // 头像和内容间距
                img {
                    width: 100%;
                    height: 100%;
                    border-radius: 50%;
                }
            }
            .dialog-content {
                @include padding(10, 12); // 增加内边距
                width: px2rem(200);
                white-space: pre-wrap;
                background: $user-msg-bg; // 微信绿
                color: #000000; // 黑色文字
                @include border-radius(8);
                box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            }
        }
        .dialog-ai {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: flex-start;
            width: px2rem(260);
            height: auto;
            margin-top: px2rem(10);
            margin-bottom: px2rem(10);
            margin-left: px2rem(15); // 距左边15px
            .dialog-face {
                @include size(32);
                img {
                    width: 100%;
                    height: 100%;
                    border-radius: 50%;
                }
            }
            .dialog-content {
                margin-left: px2rem(10);
                @include padding(10, 12); // 增加内边距
                width: px2rem(220);
                white-space: pre-wrap;
                @include border-radius(8);
                border: 1px solid $ai-msg-border; // 浅灰边框
                background: $ai-msg-bg; // 白色背景
                color: #000000; // 黑色文字
                box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            }
            
            .dialog-control {
                margin-top: px2rem(12);
                margin-bottom: px2rem(8);
                display: flex;
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                gap: px2rem(8);
                
                .dialog-btn {
                    flex: 1;
                    min-width: px2rem(93);
                    height: px2rem(36);
                    display: flex;
                    flex-direction: row;
                    align-items: center;
                    justify-content: center;
                    @include border-radius(6);
                    border: 1px solid rgba(255, 255, 255, 0.3);
                    background: linear-gradient(135deg, #52c97f 0%, #43c94a 100%);
                    color: white;
                    @include font-size(13);
                    font-weight: 500;
                    cursor: pointer;
                    transition: all 0.2s;
                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                    
                    &:active {
                        transform: translateY(1px);
                        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
                    }
                    
                    .btn-icon {
                        @include size(18);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        
                        img {
                            height: 100%;
                            width: 100%;
                            filter: brightness(0) invert(1); // 图标变白色
                        }
                    }
                    
                    // 为"生成模板"按钮创建特殊图标样式
                    &:first-child .btn-icon {
                        position: relative;
                        
                        img {
                            display: none; // 隐藏原图标
                        }
                        
                        // 白色圆圈
                        &::before {
                            content: '';
                            position: absolute;
                            @include size(18);
                            background: white;
                            border-radius: 50%;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                        }
                        
                        // 绿色对勾
                        &::after {
                            content: '✓';
                            position: absolute;
                            color: #43c94a;
                            @include font-size(14);
                            font-weight: bold;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            z-index: 1;
                        }
                    }
                    
                    .btn-text {
                        margin-left: px2rem(6);
                        letter-spacing: 0.5px;
                    }
                }
                
                .dialog-btn:nth-child(2) {
                    background: linear-gradient(135deg, #ff8a65 0%, #f4511e 100%);
                    border: 1px solid rgba(255, 255, 255, 0.3);
                }
            }
        }
    }
    .input-container {
        width: 100%;
        height: auto;
        min-height: px2rem(70); // 增加最小高度
        position: relative; // 改为相对定位，作为底部固定元素
        bottom: 0;
        background-color: #f0f0f0; // 稍深灰色，区分对话区域
        border-top: 1px solid #d0d0d0; // 边框颜色
        display: flex;
        flex-direction: row;
        gap: px2rem(12); // 间距
        align-items: flex-end; // 底部对齐
        justify-content: center;
        @include padding(15); // 统一内边距
        box-sizing: border-box;
        flex-shrink: 0; // 不允许收缩
        
        .input-text { 
            @include font-size(15);
            box-sizing: border-box;
            white-space: pre-wrap;
            width: calc(100% - #{px2rem(72)}); // 自适应宽度
            max-width: px2rem(250);
            height: px2rem(40); // 固定初始高度
            min-height: px2rem(40);
            max-height: px2rem(120); // 限制最大高度
            @include padding(10, 12);
            border: 1px solid #d0d0d0;
            @include border-radius(8);
            background-color: white;
            resize: none;
            overflow-y: auto; // 内容超出时可滚动
            line-height: 1.4;
            
            &:focus {
                outline: none;
                border: 1px solid #43c94a;
                box-shadow: 0 0 0 2px rgba(67, 201, 74, 0.1);
            }
        }
        
        .input-btn {
            width: px2rem(60);
            height: px2rem(40); // 与输入框初始高度一致
            @include font-size(15);
            font-weight: 500;
            flex-shrink: 0; // 不允许收缩
            border: none;
            @include border-radius(8);
            background: #43c94a;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            
            &:active {
                transform: scale(0.95);
                background: #3ab841;
            }
        }
    }
}